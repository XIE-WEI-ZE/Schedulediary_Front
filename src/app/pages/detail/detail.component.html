<div class="detail-wrapper">
  <div class="detail-card" *ngIf="todo">
    <!-- æŒ‰éˆ•ç§»åˆ°å³ä¸Šè§’ -->
    <div class="button-group">
      <button class="btn-back" (click)="back()" title="è¿”å›åˆ—è¡¨">
        <i class="fas fa-arrow-left"></i>
      </button>
      <button class="btn-edit" *ngIf="!isEditing" (click)="enableEdit()" title="ç·¨è¼¯">
        <i class="fas fa-edit"></i>
      </button>
      <button class="btn-edit" *ngIf="isEditing" (click)="saveEdit()" title="å„²å­˜">
        <i class="fas fa-save"></i>
      </button>
      <button class="btn-delete" (click)="deleteTodo()" title="åˆªé™¤">
        <i class="fas fa-trash"></i>
      </button>
    </div>

    <h2 *ngIf="!isEditing">{{ todo.title }}</h2>
    <input *ngIf="isEditing" type="text" [(ngModel)]="editedTodo.title" placeholder="è¼¸å…¥æ¨™é¡Œ" />

    <p>
      <strong>ğŸ“… æ—¥æœŸï¼š</strong>
      <span *ngIf="!isEditing">{{ todo.date }}</span>
      <input *ngIf="isEditing" type="datetime-local" [(ngModel)]="editedTodo.date" />
    </p>

    <div class="status-section">
      <strong>âœ… ç‹€æ…‹ï¼š</strong>
      <span *ngIf="!isEditing" [ngClass]="{'completed': todo.isCompleted, 'uncompleted': !todo.isCompleted}">
        {{ todo.isCompleted ? 'å·²å®Œæˆ' : 'æœªå®Œæˆ' }}
      </span>
      <!-- ç·¨è¼¯æ¨¡å¼æ™‚ä½¿ç”¨ radio æŒ‰éˆ•é¸æ“‡æ˜¯å¦å®Œæˆ -->
      <div *ngIf="isEditing">
        <label>
          <input type="radio" name="isCompleted" [(ngModel)]="editedTodo.isCompleted" [value]="true" /> æ˜¯
        </label>
        <label>
          <input type="radio" name="isCompleted" [(ngModel)]="editedTodo.isCompleted" [value]="false" /> å¦
        </label>
      </div>
    </div>

    <p>
      <strong>ğŸ“„ å…§å®¹ï¼š</strong>
      <span *ngIf="!isEditing">{{ todo.content }}</span>
      <textarea *ngIf="isEditing" [(ngModel)]="editedTodo.content" placeholder="è¼¸å…¥å…§å®¹"></textarea>
    </p>

    <!-- å„ªå…ˆç´šï¼ˆæ˜Ÿæ˜Ÿï¼‰ -->
    <p>
      <strong>ğŸ”¥ å„ªå…ˆç´šï¼š</strong>
      <!-- é¡¯ç¤ºæ¨¡å¼ï¼šä»¥æ˜Ÿæ˜Ÿå½¢å¼é¡¯ç¤º -->
      <span *ngIf="!isEditing">
        <span class="star-rating">
          <i
            *ngFor="let star of [1, 2, 3, 4, 5]"
            class="fa-star"
            [class.fa-solid]="todo.priorityLevel >= star"
            [class.fa-regular]="todo.priorityLevel < star"
          ></i>
        </span>
      </span>
      <!-- ç·¨è¼¯æ¨¡å¼ï¼šä»¥æ˜Ÿæ˜Ÿå½¢å¼é¸æ“‡ -->
      <span *ngIf="isEditing">
        <span class="star-rating">
          <i
            *ngFor="let star of [1, 2, 3, 4, 5]"
            class="fa-star"
            [class.fa-solid]="(editedTodo.priorityLevel ?? 0) >= star"
            [class.fa-regular]="(editedTodo.priorityLevel ?? 0) < star"
            (click)="editedTodo.priorityLevel = star"
          ></i>
        </span>
      </span>
    </p>

    <div class="category-section">
      <strong>ğŸ“‚ é¡åˆ¥ï¼ˆæœ€å¤šä¸‰å€‹ï¼‰ï¼š</strong>
      <ng-container *ngIf="!isEditing">
        <span class="tag" *ngFor="let tag of todo.category?.split('#')">
          <span *ngIf="tag.trim() !== ''">#{{ tag }}</span>
        </span>
      </ng-container>
      <div *ngIf="isEditing">
        <span class="tag" *ngFor="let tag of editedTags; let i = index">
          #{{ tag }} <button type="button" (click)="removeTag(i)">âœ–</button>
        </span>
        <input
          type="text"
          maxlength="10"
          [(ngModel)]="tagInput"
          placeholder="è¼¸å…¥æ¨™ç±¤å¾ŒæŒ‰ Enter æˆ–æ–°å¢"
          (keydown.enter)="addTag()"
        />
        <button type="button" class="btn-add-tag" (click)="addTag()">æ–°å¢æ¨™ç±¤</button>
      </div>
    </div>
  </div>
</div>